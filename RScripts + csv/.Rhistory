CoordSignificant = pc1$x[,1:nd]
RotationSignificant = pc1$rotation[,1:nd]
CorSignificant = cor(dcon,CoordSignificant) #Correlation variables to every significant PCA
# STORAGE OF LABELS FOR INDIVIDUALS AND VARIABLES.
rownSeq = row.names(dcon)
etiq = names(dcon)
#Quality of the variables on the PCAs. (Useful not only to see which variables are well represented, but also which ones are not)
#- it is measured as the SQUARE COSINE, square of the correlation of the variables to the PCAs. The correlation between a variable and a principal component (PC) is used as the coordinates of the variable on the PC
#- A high cos2 indicates a good representation of the variable on the principal component. In this case the variable is positioned close to the circumference of the correlation circle.
#- A low cos2 indicates that the variable is not perfectly represented by the PCs. In this case the variable is close to the center of the circle.
#- For a given variable, the sum of the cos2 on all the principal components is equal to one.
SquareCorSignificant = CorSignificant^2
corrplot(SquareCorSignificant, is.corr=FALSE, title="Quality of the variables on the PCAs (square cosine of the correlation)",col =COL2('PR'), bg = '#F1F1F1', tl.col = 'black', mar=c(0,0,2,0))
View(dcon)
View(dd)
fviz_pca_biplot(pc1,
# Fill individuals by groups
geom.ind = "point",
pointshape = 21,
pointsize = 2.5,
fill.ind = dd$Zone,
col.ind = "black",
# Color variable by groups
col.var = factor(c("sepal", "sepal", "petal", "petal")),
legend.title = list(fill = "Species", color = "Clusters"),
repel = TRUE        # Avoid label overplotting
)+
ggpubr::fill_palette("jco")+      # Indiviual fill color
ggpubr::color_palette("npg")      # Variable colors
fviz_pca_biplot(pc1,
col.ind = dd$Zone, palette = "jco",
addEllipses = TRUE, label = "var",
col.var = "black", repel = TRUE,
legend.title = "Species")
fviz_pca_biplot(pc1,
col.ind = dd$Zone, palette = "jco",
addEllipses = TRUE, label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2.5, col.ind = "black") + ggpubr::color_palette("npg")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
addEllipses = TRUE, label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2.5, col.ind = "black") + ggpubr::color_palette("npg")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "npg",
addEllipses = TRUE, label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2.5, col.ind = "black") + ggpubr::color_palette("npg")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "npg",
addEllipses = TRUE, label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2.5, col.ind = "black") + ggpubr::color_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "npg",
addEllipses = TRUE, label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2.5, col.ind = "black")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "npg",
addEllipses = TRUE, label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2.5, col.ind = "black") + ggpubr::color_palette("white")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "npg",
addEllipses = TRUE, label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2.5, col.ind = "black") + ggpubr::color_palette("white", "White")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "npg",
addEllipses = TRUE, label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2.5, col.ind = "black") + ggpubr::color_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "npg",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2.5, col.ind = "black", addEllipses = TRUE) + ggpubr::color_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "npg",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2.5, col.ind = "black", addEllipses = TRUE) + ggpubr::color_palette("jco") + ggpubr::fill_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "npg",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2.5, col.ind = "black", addEllipses = TRUE) + ggpubr::color_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "npg",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2.5, col.ind = "black", addEllipses = TRUE) + ggpubr::color_palette("npg")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2.5, col.ind = "black", addEllipses = TRUE) + ggpubr::color_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 22,
pointsize = 2.5, col.ind = "black", addEllipses = TRUE) + ggpubr::color_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE) + ggpubr::color_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "confidence") + ggpubr::color_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "convex") + ggpubr::color_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "t") + ggpubr::color_palette("jco")
#CHECKEJA LA INSTALACIO DELS PACKAGES NECESARIS
list.of.packages <- c("rstudioapi","remotes", "ggplot2", "hrbrthemes", "showtext", "jsonlite", "curl", "sysfonts", "corrplot", "ggforce", "ggpubr", "ggrepel", "factoextra") #posar els packages que es facin servir
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "norm") + ggpubr::color_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "euclid") + ggpubr::color_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "norm") + ggpubr::color_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "norm", ellipse.level = 0.5) + ggpubr::color_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "norm") + ggpubr::color_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE) + ggpubr::color_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "norm", geom.var = c("point", "text")) + ggpubr::color_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "confidence") + ggpubr::color_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "convex") + ggpubr::color_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "normal") + ggpubr::color_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "normal") + ggpubr::color_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "norm") + ggpubr::color_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "norm") + ggpubr::color_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "norm", mean.point = TRUE) + ggpubr::color_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "norm", mean.point = FALSE) + ggpubr::color_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "norm", mean.point = TRUE) + ggpubr::color_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "norm") + ggpubr::color_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "norm", mean.point = TRUE, addlabel=TRUE) + ggpubr::color_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "norm", mean.point = TRUE, addlabel=FALSE) + ggpubr::color_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "norm", mean.point = TRUE, addlabel=TRUE, mean.point.size = 2) + ggpubr::color_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "norm", mean.point = TRUE, addlabel=TRUE, mean.point.size = 20) + ggpubr::color_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "norm", mean.point = TRUE, addlabel=TRUE, mean.point.size = 10) + ggpubr::color_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "norm", addlabel=TRUE, mean.point.size = 10) + ggpubr::color_palette("jco")
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "norm", addlabel=TRUE, mean.point.size = 10) +
ggpubr::color_palette("jco") +
theme_ipsum_rc(base_size=15, plot_title_size = 22, axis_title_size = 13)
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "norm", addlabel=TRUE, mean.point.size = 10) +
ggpubr::color_palette("jco") +
scale_x_continuous(breaks=seq(-100, 100, 5), minor_breaks=seq(-100, 100, 5)) +
scale_y_continuous(breaks=seq(-100, 100, 5), minor_breaks=seq(-100, 100, 5)) +
theme_ipsum_rc(base_size=15, plot_title_size = 22, axis_title_size = 13)
color_palette1 = c("#4B5D67", "#322F3D", "#59405C", "#87556F")
colorIteration=1
for (x in seq(nd-1)) {
for (y in seq(x+1, nd)) {
print(ggplot(mapping = aes(x=CoordSignificant[, x],y=CoordSignificant[, y])) +
geom_point(size = 1.5, alpha = 4/10, color=(colorIteration%%(length(color_palette1)[1]))+1) +
labs(title = "Individuals plot", subtitle= "Points transparency according to the frequency on that exact point" , x = paste0("PCA", x, " (", pinerEix[x], ' %)'), y = paste0("PCA", y, " (", pinerEix[y], ' %)')) +
scale_x_continuous(breaks=seq(-100, 100, 5), minor_breaks=seq(-100, 100, 5)) +
scale_y_continuous(breaks=seq(-100, 100, 5), minor_breaks=seq(-100, 100, 5)) +
geom_hline(yintercept=0, linetype="dashed") +
geom_vline(xintercept=0, linetype="dashed") +
theme_ipsum_rc(base_size=15, plot_title_size = 22, axis_title_size = 13))
colorIteration = colorIteration+1
}
}
color_palette1 = c("#4B5D67", "#322F3D", "#59405C", "#87556F")
colorIteration=1
for (x in seq(nd-1)) {
for (y in seq(x+1, nd)) {
print(ggplot(mapping = aes(x=CoordSignificant[, x],y=CoordSignificant[, y])) +
geom_point(size = 1.5, alpha = 4/10, color=(colorIteration%%(length(color_palette1)[1]))+1) +
labs(title = "Individuals plot", subtitle= "Points transparency according to the frequency on that exact point" , x = paste0("PCA", x, " (", pinerEix[x], ' %)'), y = paste0("PCA", y, " (", pinerEix[y], ' %)')) +
scale_x_continuous(breaks=seq(-100, 100, 5), minor_breaks=seq(-100, 100, 5)) +
scale_y_continuous(breaks=seq(-100, 100, 5), minor_breaks=seq(-100, 100, 5)) +
geom_hline(yintercept=0, linetype="dashed") +
geom_vline(xintercept=0, linetype="dashed") +
theme_ipsum_rc(base_size=15, plot_title_size = 22, axis_title_size = 13))
colorIteration = colorIteration+1
}
}
fviz_pca_biplot(pc1,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "norm", addlabel=TRUE, mean.point.size = 10) +
ggpubr::color_palette("jco") +
scale_x_continuous(breaks=seq(-100, 100, 5), minor_breaks=seq(-100, 100, 5)) +
scale_y_continuous(breaks=seq(-100, 100, 5), minor_breaks=seq(-100, 100, 5)) +
theme_ipsum_rc(base_size=15, plot_title_size = 22, axis_title_size = 13)
fviz_pca_biplot(pc1, axes = 1:3,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "norm", addlabel=TRUE, mean.point.size = 10) +
ggpubr::color_palette("jco") +
scale_x_continuous(breaks=seq(-100, 100, 5), minor_breaks=seq(-100, 100, 5)) +
scale_y_continuous(breaks=seq(-100, 100, 5), minor_breaks=seq(-100, 100, 5)) +
theme_ipsum_rc(base_size=15, plot_title_size = 22, axis_title_size = 13)
fviz_pca_biplot(pc1, axes = 2:3,
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "norm", addlabel=TRUE, mean.point.size = 10) +
ggpubr::color_palette("jco") +
scale_x_continuous(breaks=seq(-100, 100, 5), minor_breaks=seq(-100, 100, 5)) +
scale_y_continuous(breaks=seq(-100, 100, 5), minor_breaks=seq(-100, 100, 5)) +
theme_ipsum_rc(base_size=15, plot_title_size = 22, axis_title_size = 13)
fviz_pca_biplot(pc1, axes = c(1:3),
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "norm", addlabel=TRUE, mean.point.size = 10) +
ggpubr::color_palette("jco") +
scale_x_continuous(breaks=seq(-100, 100, 5), minor_breaks=seq(-100, 100, 5)) +
scale_y_continuous(breaks=seq(-100, 100, 5), minor_breaks=seq(-100, 100, 5)) +
theme_ipsum_rc(base_size=15, plot_title_size = 22, axis_title_size = 13)
fviz_pca_biplot(pc1, axes = c(1,3),
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "norm", addlabel=TRUE, mean.point.size = 10) +
ggpubr::color_palette("jco") +
scale_x_continuous(breaks=seq(-100, 100, 5), minor_breaks=seq(-100, 100, 5)) +
scale_y_continuous(breaks=seq(-100, 100, 5), minor_breaks=seq(-100, 100, 5)) +
theme_ipsum_rc(base_size=15, plot_title_size = 22, axis_title_size = 13)
dd$Zone
dd[1,]
dd[,1]
for (x in seq(nd-1)) {
for (y in seq(x+1, nd)) {
print(fviz_pca_biplot(pc1, axes = c(x,y),
fill.ind = dd$Zone, palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "norm", addlabel=TRUE, mean.point.size = 10) +
ggpubr::color_palette("jco") +
scale_x_continuous(breaks=seq(-100, 100, 5), minor_breaks=seq(-100, 100, 5)) +
scale_y_continuous(breaks=seq(-100, 100, 5), minor_breaks=seq(-100, 100, 5)) +
labs(title = "Correlation circle, Individuals, and representacion of the 'Zone' categorical variable", subtitle= "Correlation vectors are scaled for clarity.\nConcentration ellipses (using multivariate normal distribution) are drawn. Mean points for the levels are also drawn." , x = paste0("PCA", x, " (", pinerEix[x], ' %)'), y = paste0("PCA", y, " (", pinerEix[y], ' %)')) +
theme_ipsum_rc(base_size=15, plot_title_size = 22, axis_title_size = 13))
}
}
dd$Zone
dd[,1]
for (x in seq(nd-1)) {
for (y in seq(x+1, nd)) {
print(fviz_pca_biplot(pc1, axes = c(x,y),
fill.ind = dd[,1], palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = "Zone", geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "norm", addlabel=TRUE, mean.point.size = 10) +
ggpubr::color_palette("jco") +
scale_x_continuous(breaks=seq(-100, 100, 5), minor_breaks=seq(-100, 100, 5)) +
scale_y_continuous(breaks=seq(-100, 100, 5), minor_breaks=seq(-100, 100, 5)) +
labs(title = "Correlation circle, Individuals, and representation of the 'Zone' categorical variable", subtitle= "Correlation vectors are scaled for clarity.\nConcentration ellipses (using multivariate normal distribution) are drawn. Mean points for the levels are also drawn." , x = paste0("PCA", x, " (", pinerEix[x], ' %)'), y = paste0("PCA", y, " (", pinerEix[y], ' %)')) +
theme_ipsum_rc(base_size=15, plot_title_size = 22, axis_title_size = 13))
}
}
dd[,2]
sapply(dd,class)
factors<-which(sapply(dd,is.factor))
factors
dfactors<-dd[,factors]
View(dfactors)
for (var in factors) {
print(var)
}
rownames(dd)[1]
colnames(dd)[1]
for (x in seq(nd-1)) {
for (y in seq(x+1, nd)) {
for(varNumber in factors) {
print(fviz_pca_biplot(pc1, axes = c(x,y),
fill.ind = dd[,varNumber], palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = colnames(dd)[varNumber], geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "norm", addlabel=TRUE, mean.point.size = 10) +
ggpubr::color_palette("jco") +
scale_x_continuous(breaks=seq(-100, 100, 5), minor_breaks=seq(-100, 100, 5)) +
scale_y_continuous(breaks=seq(-100, 100, 5), minor_breaks=seq(-100, 100, 5)) +
labs(title = "Correlation circle, Individuals, and representation of the " + colnames(dd)[varNumber] + " categorical variable", subtitle= "Correlation vectors are scaled for clarity.\nConcentration ellipses (using multivariate normal distribution) are drawn. Mean points for the levels are also drawn." , x = paste0("PCA", x, " (", pinerEix[x], ' %)'), y = paste0("PCA", y, " (", pinerEix[y], ' %)')) +
theme_ipsum_rc(base_size=15, plot_title_size = 22, axis_title_size = 13))
}
}
}
for (x in seq(nd-1)) {
for (y in seq(x+1, nd)) {
for(varNumber in factors) {
print(fviz_pca_biplot(pc1, axes = c(x,y),
fill.ind = dd[,varNumber], palette = "jco",
label = "var",
col.var = rgb(0.5,0.5,0.5), repel = TRUE,
legend.title = colnames(dd)[varNumber], geom.ind = "point",
pointshape = 21,
pointsize = 2, col.ind = "black", addEllipses = TRUE, ellipse.type = "norm", addlabel=TRUE, mean.point.size = 10) +
ggpubr::color_palette("jco") +
scale_x_continuous(breaks=seq(-100, 100, 5), minor_breaks=seq(-100, 100, 5)) +
scale_y_continuous(breaks=seq(-100, 100, 5), minor_breaks=seq(-100, 100, 5)) +
labs(title = paste0("Correlation circle, Individuals, and representation of the ",colnames(dd)[varNumber], " categorical variable"), subtitle= "Correlation vectors are scaled for clarity.\nConcentration ellipses (using multivariate normal distribution) are drawn. Mean points for the levels are also drawn." , x = paste0("PCA", x, " (", pinerEix[x], ' %)'), y = paste0("PCA", y, " (", pinerEix[y], ' %)')) +
theme_ipsum_rc(base_size=15, plot_title_size = 22, axis_title_size = 13))
}
}
}
